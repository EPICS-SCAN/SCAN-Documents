function graph_split_data(filename)
% Open file 
data = fopen(filename, "r");

% Create a single figure for all plots
fig = figure(); % Explicitly create and store the figure handle
ax = axes('Parent', fig); % Create axes in that figure
hold(ax, 'on'); % Hold on for these specific axes

% Set labels and title
xlabel(ax, "Time");
ylabel(ax, "Distance");
title(ax, "Time vs Distance (All Data)");
grid(ax, 'on');

% Initialize color index for different segments
colorOrder = get(ax, 'ColorOrder');
colorIndex = 1;

% Initialize time and distance vectors for current segment
time = [];
distance = [];

while ~feof(data) % Will check till end of file is reached
    line = fgetl(data); % Reads one line of data at a time

    if contains(line, "---") % Checks for dashed line
        if ~isempty(time) && ~isempty(distance) 
            % Plot the current segment with a distinct color
            plot(ax, time, distance, "LineWidth", 1.5, 'Color', colorOrder(colorIndex, :));
            
            % Cycle through colors
            colorIndex = mod(colorIndex, size(colorOrder, 1)) + 1;
        end
        % Reset time and distance vectors 
        time = [];
        distance = [];
        continue;
    end
    
    line = strrep(line, ",", " "); % Replace commas with spaces
    numeric = str2num(line); % Convert from string to numeric values
    if length(numeric) == 2
        time = [time; numeric(1)]; % Appending time value
        distance = [distance; numeric(2)]; % Appending distance value
    end
end

% Plot the last segment if it exists
if ~isempty(time) && ~isempty(distance)
    plot(ax, time, distance, "LineWidth", 1.5, 'Color', colorOrder(colorIndex, :));
end

hold(ax, 'off'); % Release the hold on the axes
fclose(data); % Close file
end
